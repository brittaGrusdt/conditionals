---
title: "Model sundowners and skiing example"
author: "Britta Grusdt"
date: "5/6/2019"
output: html_document
---

```{r}
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
```

```{r helpers, echo = FALSE}
library(tidyverse)
library(ggplot2)
source(file.path("..", "helpers.R", fsep = .Platform$file.sep))
```

Get Data

```{r}
fn_skiing <- file.path("..", "..", "data", "results", "skiing.rds",
                       fsep = .Platform$file.sep)
fn_sundowners <- file.path("..", "..", "data", "results", "sundowners.rds",
                           fsep = .Platform$file.sep)
skiing <- read_rds(fn_skiing) 
sundowners <- read_rds(fn_sundowners)
```

# Skiing example
## Prior

```{r}
distr <- "prior"
skiing[[distr]] %>% plot_cns(distr)
skiing[[distr]] %>% plot_bns(distr)
skiing[[distr]] %>% plot_bn_table(1, distr)

skiing[[distr]] %>% plot_marginal(c("E"), distr)
```

## Literal Listener

```{r}
distr <- "LL"
# skiing[[distr]] %>% plot_cns(distr)
skiing[[distr]] %>% plot_bns(distr)
skiing[[distr]] %>% plot_bn_table(1, distr)

skiing[[distr]] %>% plot_marginal(c("E"), distr)
```

## Pragmatic Listener
The listener has evidence for variable *C* (buying clothes); i.e. the
distribution of the single bayes net that receives non-zero probability after
hearing *If she passes the exam, her father takes her on a skiing trip* (E > S),
is conditioned on *C=TRUE*.

```{r}
distr <- "PL"
# skiing[[distr]] %>% plot_cns(distr)
# skiing[[distr]] %>% plot_bns(distr)
skiing[[distr]] %>% plot_bn_table(1, distr)

skiing[[distr]] %>% plot_marginal(c("E"), distr)

```


# Sundowners example

## Prior

```{r}
distr <- "prior"
sundowners[[distr]] %>% plot_cns(distr)
sundowners[[distr]] %>% plot_bns(distr)

sundowners[[distr]] %>% plot_bn_table(1, distr)
sundowners[[distr]] %>% plot_bn_table(4, distr)

sundowners[[distr]] %>% plot_marginal(c("R"), distr)

```

## Literal Listener

```{r}
distr <- "LL"
# sundowners[[distr]] %>% plot_cns(distr)
sundowners[[distr]] %>% plot_bns(distr)
sundowners[[distr]] %>% plot_bn_table(1, distr)

sundowners[[distr]] %>% plot_marginal(c("R"), distr)

```

## Pragmatic Listener

```{r}
distr <- "PL"
# sundowners[[distr]] %>% plot_cns(distr)
sundowners[[distr]] %>% plot_bns(distr)
sundowners[[distr]] %>% plot_bn_table(2, distr)

sundowners[[distr]] %>% plot_marginal(c("R"), distr)


```


